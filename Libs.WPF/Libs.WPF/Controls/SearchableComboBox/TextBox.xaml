<ResourceDictionary xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                    xmlns:helpers="clr-namespace:Libs.WPF.Helpers">

    <ResourceDictionary.MergedDictionaries>
        <ResourceDictionary Source="Button.xaml" />
    </ResourceDictionary.MergedDictionaries>

    <Style x:Key="TextBoxStyleComboxBoxEditable"
           TargetType="{x:Type TextBox}">
        <Setter Property="helpers:TextBoxHelper.IsMonitoring"
                Value="True" />
        <Setter Property="Background"
                Value="#FCFCFC" />
        <Setter Property="MinHeight"
                Value="20" />
        <Setter Property="BorderThickness"
                Value="2,0,2,2" />
        <Setter Property="BorderBrush"
                Value="Transparent" />
        <Setter Property="Padding"
                Value="4 0 0 0" />
        <Setter Property="VerticalAlignment"
                Value="Center" />
        <Setter Property="VerticalContentAlignment"
                Value="Center" />
        <Setter Property="Foreground"
                Value="#33383F" />
        <Setter Property="SnapsToDevicePixels"
                Value="True" />
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type TextBox}">
                    <Grid>
                        <Border Name="SubBorderTb"
                                Grid.Row="1"
                                Background="{TemplateBinding Background}"
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="0"
                                CornerRadius="8"
                                SnapsToDevicePixels="True">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="auto" />
                                    <ColumnDefinition />
                                    <ColumnDefinition Width="auto" />
                                </Grid.ColumnDefinitions>
                                <TextBlock x:Name="PART_WaterMark"
                                           Grid.Column="1"
                                           Margin="8,0,0,0"
                                           Padding="4"
                                           HorizontalAlignment="Left"
                                           VerticalAlignment="{TemplateBinding VerticalAlignment}"
                                           Foreground="#9A9FA5"
                                           IsHitTestVisible="True"
                                           Text="{TemplateBinding helpers:TextBoxHelper.WatermarkText}" />
                                <ScrollViewer x:Name="PART_ContentHost"
                                              Grid.Column="1"
                                              Margin="1"
                                              Padding="4 0 0 0"
                                              VerticalAlignment="{TemplateBinding VerticalAlignment}"
                                              VerticalContentAlignment="{TemplateBinding VerticalContentAlignment}" />
                                <Button x:Name="PART_ButtonClear"
                                        Grid.Column="2"
                                        Margin="0 0 4 0"
                                        HorizontalAlignment="Center"
                                        VerticalAlignment="Center"
                                        helpers:TextBoxHelper.IsClearTextButtonBehaviorEnabled="True"
                                        Style="{StaticResource ButtonClearTextStyle}" />
                                <Border x:Name="PART_CircleClear"
                                        Grid.Column="2"
                                        Width="22"
                                        Height="22"
                                        Margin="0 0 4 0"
                                        HorizontalAlignment="Center"
                                        VerticalAlignment="Center"
                                        Background="{TemplateBinding Background}"
                                        CornerRadius="21"
                                        Visibility="Visible" />

                            </Grid>
                        </Border>
                    </Grid>

                    <ControlTemplate.Triggers>
                        <Trigger Property="IsEnabled"
                                 Value="false">
                            <Setter TargetName="SubBorderTb"
                                    Property="Background"
                                    Value="{DynamicResource {x:Static SystemColors.ControlBrushKey}}" />
                            <Setter Property="Foreground"
                                    Value="{DynamicResource {x:Static SystemColors.GrayTextBrushKey}}" />
                        </Trigger>

                        <Trigger Property="IsFocused"
                                 Value="True">
                            <Setter TargetName="SubBorderTb"
                                    Property="Background"
                                    Value="#FFFFFF" />
                            <Setter TargetName="PART_CircleClear"
                                    Property="Visibility"
                                    Value="Collapsed" />
                            <Setter TargetName="PART_CircleClear"
                                    Property="Background"
                                    Value="#FFFFFF" />

                        </Trigger>

                        <MultiTrigger>
                            <MultiTrigger.Conditions>
                                <Condition Property="IsFocused"
                                           Value="False" />
                                <Condition Property="helpers:TextBoxHelper.HasText"
                                           Value="True" />
                            </MultiTrigger.Conditions>
                            <Setter TargetName="SubBorderTb"
                                    Property="Background"
                                    Value="#FFFFFF" />
                            <Setter TargetName="PART_CircleClear"
                                    Property="Visibility"
                                    Value="Visible" />
                            <Setter TargetName="PART_CircleClear"
                                    Property="Background"
                                    Value="#FFFFFF" />
                        </MultiTrigger>
                        <MultiTrigger>
                            <MultiTrigger.Conditions>
                                <Condition Property="IsFocused"
                                           Value="true" />
                                <Condition Property="helpers:TextBoxHelper.HasText"
                                           Value="False" />
                            </MultiTrigger.Conditions>
                            <Setter TargetName="PART_WaterMark"
                                    Property="Opacity"
                                    Value="0.5" />
                            <Setter TargetName="PART_CircleClear"
                                    Property="Visibility"
                                    Value="Visible" />
                        </MultiTrigger>
                        <MultiTrigger>
                            <MultiTrigger.Conditions>
                                <Condition Property="helpers:TextBoxHelper.HasText"
                                           Value="True" />
                            </MultiTrigger.Conditions>
                            <Setter TargetName="PART_WaterMark"
                                    Property="Visibility"
                                    Value="Collapsed" />
                        </MultiTrigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

</ResourceDictionary>